#############################################################################
# Makefile for building first
# Generated by tmake at 12:09, 2009/05/25
#     Project: first
#    Template: app
#############################################################################

####### Compiler, tools and options

CC	=	arm-linux-gcc
CXX	=	arm-linux-g++
CFLAGS	=	-pipe -Wall -W -O2 -DNO_DEBUG
CXXFLAGS=	-pipe -DQWS -fno-exceptions -fno-rtti -Wall -W -O2 -DNO_DEBUG
INCPATH	=	-I$(QTDIR)/include -I$(QPEDIR)/include
LINK	=	arm-linux-g++
LFLAGS	=	
LIBS	=	$(SUBLIBS) -L$(QPEDIR)/lib -L$(QTDIR)/lib -lm -lqpe -lqtopia -lqte -lpthread
MOC	=	$(QTDIR)/bin/moc
UIC	=	$(QTDIR)/bin/uic

TAR	=	tar -cf
GZIP	=	gzip -9f

####### Files

HEADERS =	first.h console.h config.h datatrans.h Monitor.h SettingDlg.h
SOURCES =	first.cpp \
		console.cpp \
		uart1.c \
		datatrans.cpp \
		Monitor.cpp \
		SettingDlg.cpp \
		main.cpp
OBJECTS =	main.o \
		first.o \
		uart1.o \
		datatrans.o \
		Monitor.o \
		SettingDlg.o \
		console.o
INTERFACES =	first.ui console.ui Monitor.ui SettingDlg.ui
UICDECLS =	first.h console.h config.h uart1.h datatrans.h Monitor.h SettingDlg.h
UICIMPLS =	first.cpp console.cpp uart.c datatrans.cpp Monitor.cpp SettingDlg.cpp
SRCMOC	=	moc_first.cpp moc_console.cpp moc_Monitor.cpp moc_SettingDlg.cpp
OBJMOC	=	moc_first.o moc_console.o moc_Monitor.o moc_SettingDlg.o
DIST	=	
TARGET	=	$(QPEDIR)/image/opt/Qtopia/bin/first
DESKTOP =	$(QPEDIR)/image/opt/Qtopia/apps/EmbedSky/first.desktop
ICON =		$(QPEDIR)/image/opt/Qtopia/pics/logo.png
INTERFACE_DECL_PATH = .

####### Implicit rules

.SUFFIXES: .cpp .cxx .cc .C .c

.cpp.o:
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<

.cxx.o:
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<

.cc.o:
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<

.C.o:
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<

.c.o:
	$(CC) -c $(CFLAGS) $(INCPATH) -o $@ $<

####### Build rules


all: $(TARGET)
	cp -f first.desktop $(DESKTOP)
	cp -f logo.png $(ICON)

$(TARGET): $(UICDECLS) $(OBJECTS) $(OBJMOC) 
	$(LINK) $(LFLAGS) -o $(TARGET) $(OBJECTS) $(OBJMOC) $(LIBS)
	
	@echo "comile over------------------[ok]"

moc: $(SRCMOC)

tmake: Makefile

Makefile: first.pro
	tmake first.pro -o Makefile

dist:
	$(TAR) first.tar first.pro $(SOURCES) $(HEADERS) $(INTERFACES) $(DIST)
	$(GZIP) first.tar

clean:
#	-rm -f $(OBJECTS) $(OBJMOC) $(DESKTOP) $(ICON) $(TARGET)

	-rm -f $(OBJECTS) $(OBJMOC) $(TARGET)
	-rm -f *~ core

####### Sub-libraries


###### Combined headers


####### Compile
first.o: first.cpp \
		first.h \
		config.h \
		console.h \
		datatrans.h \
		first.ui
console.o:console.cpp \
		console.h \
		config.h \
		uart1.h \
		console.ui
uart.o:uart1.c \
		uart1.h
datatrans.o:datatrans.cpp \
		uart1.h \
		datatrans.h \
		config.h
Monitor.o:Monitor.h \
		Monitor.cpp \
		config.h
SettingDlg.o:SettingDlg.h \
		SettingDlg.cpp \ 
		config.h
main.o: main.cpp \
		first.h \
		console.h \
		config.h \
		uart1.h \
		datatrans.h \
		Monitor.h \
		SettingDlg.h \
		/opt/EmbedSky/Qte/arm-qtopia-2.2.0/qtopia/include/qtopia/qpeapplication.h

########## for first.ui
first.h: first.ui
	$(UIC) first.ui -o $(INTERFACE_DECL_PATH)/first.h

first.cpp: first.ui
	$(UIC) first.ui -i first.h -o first.cpp
	
moc_first.o: moc_first.cpp \
		first.h

moc_first.cpp: first.h
	$(MOC) first.h -o moc_first.cpp
	
########## for console.ui
console.h: console.ui
	$(UIC) console.ui -o $(INTERFACE_DECL_PATH)/console.h
	
console.cpp:console.h
	$(UIC) console.ui -i console.h -o console.cpp

moc_console.o: moc_console.cpp \
		console.h

moc_console.cpp: console.h
	$(MOC) console.h -o moc_console.cpp

########## for Monitor.ui
Monitor.h:Monitor.ui
	$(UIC) Monitor.ui -o $(INTERFACE_DECL_PATH)/Monitor.h
	
Monitor.cpp:Monitor.ui
	$(UIC) Monitor.ui -i Monitor.h -o Monitor.cpp

moc_Monitor.cpp:moc_Monitor.cpp \
	Monitor.h

########## for SettingDlg
SettingDlg.h:SettingDlg.ui
	$(UIC) SettingDlg.ui -o $(INTERFACE_DECL_PATH)/SettingDlg.h
	
SettingDlg.cpp:SettingDlg.ui
	$(UIC) SettingDlg.ui -i SettingDlg.h -o SettingDlg.cpp

moc_SettingDlg.cpp:moc_SettingDlg.cpp \
	SettingDlg.h